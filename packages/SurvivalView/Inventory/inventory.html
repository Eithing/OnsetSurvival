<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="inventory.css" />
</head>

<body>
    <div class="parent-container">
        <div class="ItemOption" id="ItemOption">
            <label id="ItemOption_nom">Pompe</label>
            <input type="number" id="ItemOption_input" placeholder="Entrer un nombre...">
            <div class="ItemOption_Button" id="ItemOption_Min">Min</div>
            <div class="ItemOption_Button" id="ItemOption_Middle">Moiti√©</div>
            <div class="ItemOption_Button" id="ItemOption_Max">Max</div>
            <div class="ItemOption_Button" id="ItemOption_Button">Jeter</div>
        </div>
        <div class="item-information" id="item-info">
            <div class="item-image-infos" id="infos-image">

            </div>
            <p id="close-info">x</p>
            <div id="infos-rest" style="height: 100px;position: relative;">
                <div id="infos-title"><b>Title</b></div>
                <div class="scroll" id="infos-desc"><b></b></div>
                <div style="text-align: center; text-align: center;position: absolute;bottom: 24%;">
                    <div class="infos-button" id="infos-use" style="visibility: hidden;"><b>Utiliser</b></div>
                </div>
                <div style="text-align: center;position: absolute;bottom: 2%;">
                    <div class="infos-button" id="infos-drop"><b>Jeter</b></div>
                </div>
            </div>
        </div>
        <div class="inventory-container-Global" id="player-inventory">
            <label class="title_label">Inventaire</label>
            <label id="weight_label" class="weight_label">0/<b style="font-size: 14px;">10</b></label>
            <div style="display: flex;">
                <div class="icon">
                    <svg version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 298.669 298.669" style="enable-background:new 0 0 298.669 298.669;" xml:space="preserve">
                    <path fill="#727272" d="M160.196,270.986l11.807,23.297c1.41,2.781,4.223,4.386,7.143,4.386c1.216,0,2.45-0.278,3.609-0.866c3.941-1.997,5.517-6.811,3.52-10.752l-11.719-22.874L159.336,150h138.195l-3.011-49.934C291.193,45.168,243.471,0,188.471,0h-87C46.471,0,1.138,45,1.138,100v99h91.161L160.196,270.986z M108.932,193.318l35.216-36.651l11.457,86.133L108.932,193.318z"/></svg>
                </div>
                <div class="inventory-stuff" id="player-inventory-stuff1"></div>
                <div class="icon">
                    <svg viewBox="0 0 24.669 24.669" fill-rule="evenodd" clip-rule="evenodd"><path fill="#727272" d="M6.496 22.004h10.942v2h-10.942v-2zm-3.744-.35l-2.435-.571-.317 1.35 2.435.571.317-1.35zm18.496 0l2.435-.571.317 1.35-2.435.571-.317-1.35zm-3.253-.432h-12.009v-9.218l-2.664 9-3.019-.721 3.681-16.279 4.003-1.727v-1.242s1.414-1.022 4.004-1.031c2.589-.009 4.003 1.001 4.003 1.001v1.27l4.003 1.729 3.694 16.27-3.003.73-2.693-9v9.218zm-6.004-20.217c1.657 0 3.002.338 3.002.755 0 .416-1.345.754-3.002.754-1.657 0-3.003-.338-3.003-.754 0-.417 1.346-.755 3.003-.755z"/></svg>
                </div>
                <div class="inventory-stuff" id="player-inventory-stuff2"></div>
                <div class="icon">
                    <svg height=32 witdh=32 viewbox='0 0 24 24' fill-rule="evenodd" clip-rule="evenodd"><path fill="#727272" d="M10 24h-4v-17.61c.604-.093 1.22-.315 1.779-.753.804-.628 1.352-1.627 1.564-2.837h5.321c.212 1.21.76 2.209 1.564 2.837.557.436 1.17.658 1.772.752v17.611h-4l-1.968-15-2.032 15zm-4-21.2h2.529c-.192.951-.626 1.724-1.243 2.207-.364.286-.794.476-1.286.569v-2.776zm9.479 0h2.521v2.775c-.489-.094-.916-.283-1.279-.568-.617-.483-1.05-1.256-1.242-2.207zm2.521-.8h-12v-2h12v2zm-6-1.5c.276 0 .5.224.5.5s-.224.5-.5.5-.5-.224-.5-.5.224-.5.5-.5z"/></svg>
                </div>
                <div class="inventory-stuff" id="player-inventory-stuff3"></div>
                <div class="icon">
                    <svg height=32 witdh=32 viewBox="0 0 454.258 454.258" version="1.1" id="Capa_1" x="0px" y="0px" style="enable-background:new 0 0 454.258 454.258;" xml:space="preserve" class=""><g transform="matrix(0.885942 0 0 0.885942 25.9059 25.9059)"><g>
                        <path d="M450.003,285.589l-2.341-3.443l-1.938,3.685c-12.648,24.029-54.696,38.389-88.041,38.389   c-42.46,0-252.092-6.381-279.383-7.935c-5.395-0.32-11.03-0.469-17.735-0.469c-4.159,0-8.021,0.052-11.756,0.101   c-3.244,0.043-6.305,0.084-9.181,0.084c-8.974,0-16.353-2.401-21.74-4.155c-3.491-1.136-6.249-2.033-8.533-2.033   c-1.761,0-3.188,0.542-4.241,1.612c-1.379,1.399-1.998,3.572-1.949,6.838c0.418,28.253,15.377,30.437,36.464,30.437   c2.896,0,5.979-0.041,9.247-0.084c3.718-0.05,7.563-0.101,11.689-0.101c6.604,0,12.146,0.146,17.445,0.46   c27.324,1.556,237.17,7.943,279.673,7.943c21.573,0,45.421-5.729,63.792-15.322c21.141-11.041,32.783-25.898,32.783-41.836   C454.258,294.509,452.826,289.74,450.003,285.589z" data-original="#000000" class="active-path" data-old_color="#000000" fill="#727272"/>
                        <path d="M36.795,302.434c2.875,0,5.933-0.041,9.176-0.084c3.689-0.05,7.505-0.101,11.599-0.101c6.565,0,12.062,0.146,17.308,0.46   c27.109,1.556,235.325,7.942,277.504,7.942c21.412,0,45.08-5.729,63.313-15.326c20.979-11.042,32.532-25.898,32.532-41.832   c0-23.11-26.366-30.573-54.281-38.476c-15.22-4.308-30.958-8.763-44.257-15.892c-5.99-3.218-15.123-7.882-26.253-13.456   c0.018-0.322,0.049-0.642,0.049-0.968c0-9.515-7.74-17.255-17.255-17.255c-4.271,0-8.176,1.568-11.192,4.148   c-4.031-1.982-8.164-4.01-12.368-6.069c-0.376-9.184-7.944-16.545-17.219-16.545c-3.746,0-7.207,1.213-10.038,3.249   c-3.77-1.833-7.546-3.667-11.311-5.494c0.08-0.672,0.133-1.352,0.133-2.045c0-9.514-7.74-17.254-17.254-17.254   c-4.775,0-9.101,1.951-12.228,5.095c-36.779-17.76-66.932-32.185-69.634-33.477c-1.646-1.123-3.481-1.716-5.323-1.716   c-2.97,0-5.825,1.444-7.64,3.868l-20.316,27.244c-2.722,3.687-3.791,7.403-3.178,11.048c1.214,7.222,8.664,12.338,14.65,16.448   c2.383,1.637,5.927,4.07,6.496,5.251c-0.008,0.008-0.017,0.017-0.025,0.025c-3.311,3.237-13.938,8.055-29.648,8.055   c-9.081,0-18.65-1.735-27.673-5.02c-11.041-4.02-15.603-15.05-19.268-23.913c-3.065-7.413-5.713-13.814-11.596-13.814   c-4.463,0-9.627,4.004-17.293,13.42c-26.057,33.12-24.839,83.725-23.949,120.675c0.095,3.957,0.187,7.76,0.24,11.369   C1.01,300.251,15.86,302.434,36.795,302.434z M255.188,199.765c0,0,3.342-3.308,7.473-2.071c3.595,1.076,12.096,3.366,17.297,4.658   c4.447,1.105,0.432,4.601,0.432,4.601l-67.519,61.801c-0.054,0.039-2.8,2.544-6.967,2.544c-6.727,0-19.768-0.051-25.082-0.051   c-4.417,0-0.752-3.727-0.752-3.727S255.179,199.765,255.188,199.765z M203.778,185.178c0.018-0.016,5.211-5.138,11.464-3.159   c3.17,1.003,10.61,2.85,15.355,4.178c4.058,1.135-0.245,5.321-0.247,5.325l-83.579,75.775c-0.058,0.043-1.991,3.536-8.505,3.536   c-7.351,0-21.378,0.336-27.117,0.336c-3.244,0-0.36-3.489-0.363-3.487L203.778,185.178z" data-original="#000000" class="active-path" data-old_color="#000000" fill="#727272"/>
                    </g></g> </svg>
                </div>
                <div class="inventory-stuff" id="player-inventory-stuff4"></div>

            </div>
            <div class="inventory-container scroll" id="player-inventory-container">
            </div>
            <div style="display: flex;">
                <div class="icon">
                    <svg version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 496.158 496.158" style="enable-background:new 0 0 496.158 496.158;" xml:space="preserve">
                    <path style="fill:#727272;" d="M248.082,0.003C111.07,0.003,0,111.061,0,248.085c0,137,111.07,248.07,248.082,248.07c137.006,0,248.076-111.07,248.076-248.07C496.158,111.061,385.088,0.003,248.082,0.003z"/>
                    <path style="fill:#000000d8;" d="M278.767,145.419c-3.126-4.003-7.276-6.006-12.451-6.006c-4.591,0-7.716,0.879-9.375,2.637c-1.662,1.758-5.226,6.445-10.693,14.063c-5.47,7.617-11.744,14.502-18.823,20.654c-7.082,6.152-16.53,12.012-28.345,17.578c-7.91,3.712-13.429,6.738-16.553,9.082c-3.126,2.344-4.688,6.006-4.688,10.986c0,4.298,1.586,8.082,4.761,11.353c3.172,3.273,6.812,4.907,10.913,4.907c8.592,0,25.292-9.521,50.098-28.564V335.41c0,7.814,1.806,13.722,5.42,17.725c3.612,4.003,8.397,6.006,14.355,6.006c13.378,0,20.068-9.814,20.068-29.443V161.972C283.455,154.941,281.892,149.425,278.767,145.419z"/></svg>
                </div>
                <div class="inventory-slot1 inventory-slot" id="player-inventory-slot1"></div>
                <div class="icon">
                    <svg version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 496.158 496.158" style="enable-background:new 0 0 496.158 496.158;" xml:space="preserve">
                    <path style="fill:#727272;" d="M248.082,0.003C111.07,0.003,0,111.061,0,248.085c0,137,111.07,248.07,248.082,248.07c137.006,0,248.076-111.07,248.076-248.07C496.158,111.061,385.088,0.003,248.082,0.003z"/>
                    <path style="fill:#000000d8;" d="M319.783,325.595c-4.005-3.124-9.814-4.688-17.432-4.688h-76.465c2.44-3.71,4.834-6.885,7.178-9.521c5.468-6.64,15.55-15.967,30.249-27.979c14.696-12.012,25.17-20.824,31.421-26.44c6.249-5.614,12.378-13.378,18.384-23.291c6.006-9.911,9.009-20.922,9.009-33.032c0-7.713-1.442-15.161-4.321-22.339c-2.882-7.178-6.91-13.5-12.085-18.97c-5.177-5.468-11.183-9.764-18.018-12.891c-10.547-4.688-23.291-7.031-38.232-7.031c-12.403,0-23.218,1.831-32.446,5.493s-16.846,8.473-22.852,14.429c-6.006,5.958-10.524,12.598-13.55,19.922c-3.028,7.324-4.541,14.355-4.541,21.094c0,5.566,1.611,9.961,4.834,13.184s7.274,4.834,12.158,4.834c5.566,0,9.789-1.758,12.671-5.273c2.879-3.516,5.468-8.544,7.764-15.088c2.293-6.542,3.93-10.547,4.907-12.012c7.324-11.229,17.381-16.846,30.176-16.846c6.054,0,11.646,1.369,16.772,4.102c5.127,2.735,9.178,6.569,12.158,11.499c2.978,4.933,4.468,10.524,4.468,16.772c0,5.763-1.392,11.646-4.175,17.651s-6.837,11.865-12.158,17.578c-5.324,5.713-11.989,11.403-19.995,17.065c-4.493,3.028-11.964,9.352-22.412,18.97c-10.451,9.62-22.169,21.167-35.156,34.644c-3.126,3.321-6.006,7.887-8.643,13.696c-2.637,5.812-3.955,10.474-3.955,13.989c0,5.47,2.051,10.231,6.152,14.282c4.102,4.054,9.814,6.079,17.139,6.079H306.6c6.445,0,11.254-1.659,14.429-4.98c3.172-3.319,4.761-7.372,4.761-12.158C325.789,332.97,323.786,328.722,319.783,325.595z"/></svg>
                </div>
                <div class="inventory-slot2 inventory-slot" id="player-inventory-slot2"></div>
                <div class="icon">
                    <svg version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 496.158 496.158" style="enable-background:new 0 0 496.158 496.158;" xml:space="preserve">
                    <path style="fill:#727272;" d="M248.082,0.003C111.07,0.003,0,111.061,0,248.085c0,137,111.07,248.07,248.082,248.07c137.006,0,248.076-111.07,248.076-248.07C496.158,111.061,385.088,0.003,248.082,0.003z"/>
                    <path style="fill:#000000d8;" d="M319.637,269.711c-2.637-6.395-6.569-12.231-11.792-17.505c-5.226-5.273-11.646-9.961-19.263-14.063c7.91-6.64,13.989-13.451,18.237-20.435c4.248-6.981,6.372-15.355,6.372-25.122c0-7.42-1.465-14.355-4.395-20.801s-7.276-12.108-13.037-16.992c-5.763-4.882-12.55-8.617-20.361-11.206c-7.814-2.586-16.457-3.882-25.928-3.882c-10.84,0-20.654,1.538-29.443,4.614s-16.139,7.155-22.046,12.231c-5.91,5.079-10.4,10.426-13.477,16.04c-3.076,5.617-4.614,10.963-4.614,16.04c0,5.273,1.634,9.499,4.907,12.671c3.271,3.175,6.859,4.761,10.767,4.761c3.319,0,6.249-0.586,8.789-1.758c2.538-1.172,4.296-2.783,5.273-4.834c1.659-3.809,3.49-7.86,5.493-12.158c2-4.296,4.125-7.812,6.372-10.547c2.245-2.733,5.296-4.93,9.155-6.592c3.856-1.659,8.764-2.49,14.722-2.49c8.789,0,15.77,2.71,20.947,8.13c5.175,5.42,7.764,11.891,7.764,19.409c0,9.865-3.248,17.432-9.741,22.705c-6.496,5.273-14.234,7.91-23.218,7.91h-6.006c-6.935,0-12.158,1.442-15.674,4.321c-3.516,2.882-5.273,6.665-5.273,11.353c0,4.786,1.465,8.521,4.395,11.206c2.93,2.687,7.079,4.028,12.451,4.028c1.172,0,3.809-0.194,7.91-0.586c4.102-0.389,7.127-0.586,9.082-0.586c11.133,0,19.823,3.248,26.074,9.741c6.249,6.496,9.375,15.454,9.375,26.88c0,7.716-1.831,14.502-5.493,20.361s-8.302,10.279-13.916,13.257c-5.617,2.98-11.451,4.468-17.505,4.468c-10.547,0-18.727-3.296-24.536-9.888c-5.812-6.592-11.256-16.674-16.333-30.249c-0.783-2.245-2.442-4.175-4.98-5.786c-2.541-1.611-5.177-2.417-7.91-2.417c-5.47,0-10.034,1.735-13.696,5.2c-3.662,3.468-5.493,8.034-5.493,13.696c0,4.395,1.538,9.961,4.614,16.699s7.617,13.257,13.623,19.556s13.646,11.549,22.925,15.747c9.276,4.198,19.775,6.299,31.494,6.299c11.522,0,22.046-1.831,31.567-5.493s17.748-8.739,24.683-15.234c6.933-6.493,12.181-13.891,15.747-22.192c3.563-8.299,5.347-16.894,5.347-25.781C323.592,283.018,322.273,276.109,319.637,269.711z"/></svg>
                </div>
                <div class="inventory-slot3 inventory-slot" id="player-inventory-slot3"></div>
            </div>
        </div>
</body>

</html>
<script type="text/javascript" src="./../Ressources/Js/inventory.js"></script>
<script type="text/javascript" src="./../Ressources/Js/item.js"></script>
<script>
    try {
        ue == null
    } catch (err) {
        window.ue = {
            game: {
                callevent: console.log
            }
        }
    }

    function newEl(tagType) {
        return document.createElement(tagType);
    }

    var el = document.getElementById("close-info");
    el.addEventListener("click", () => {
        CloseInfoBox();
    }, false);

    class MouseTracker {
        constructor() {
            this.position = {
                x: 0,
                y: 0
            }
            this.targetElement = null;
            this.leftClick = false;
            this.rightClick = false;
            this.middleClick = false;
            this.currentIdShow = null
            this.currentCountShow = null
            this.moveHandler = (evt) => {
                this.position.x = evt.pageX;
                this.position.y = evt.pageY;
                this.targetElement = evt.target;
            }

            let clickSwap = (button, bool) => {
                if (button == 0)
                    this.leftClick = bool;
                if (button == 1)
                    this.middleClick = bool;
                if (button == 2)
                    this.rightClick = bool;
            }

            let itemId;
            let itemCount;
            let downTarget;
            this.mouseDownHandler = (evt) => {
                downTarget = evt.target;
                if(evt.target.parentNode.children[1] != null){
                    itemCount = evt.target.parentNode.children[1].innerHTML;
                } else {
                    itemCount = 1
                }
                itemId = evt.target.parentNode.getAttribute("item-id");
                clickSwap(evt.button, true);
            }
            this.mouseUpHandler = (evt) => {
                clickSwap(evt.button, false);
                if (evt.target.className == "parent-container") {
                    inventory.removeItem(parseInt(itemId), false, true, parseInt(itemCount));
                }
                if (evt.target === downTarget && evt.target.className === "item-image") {
                    if(document.getElementById("ItemOption").style.visibility == "visible"){
                        CloseInfoBox();
                    }
                    document.getElementById("item-info").style.visibility = "visible";
                    document.getElementById("infos-image").style.backgroundImage = evt.target.style.backgroundImage;
                    document.getElementById("infos-image").style.backgroundPosition = evt.target.style.backgroundPosition;
                    document.getElementById("infos-title").innerHTML = evt.target.getAttribute("name");
                    document.getElementById("infos-desc").innerHTML = evt.target.getAttribute("desc");
                    let idToRemove = itemId;
                    this.currentIdShow = idToRemove
                    let ItemCount = evt.target.parentNode.parentNode.innerText
                    this.currentCountShow = ItemCount

                    if (evt.target.parentNode.id === "consommable") {
                        document.getElementById("infos-use").style.visibility = "visible";
                    }
                }
                let elements = document.getElementsByClassName("inventory-slot");
                for (var i = 0; i < elements.length; i++) {
                    elements[i].style.backgroundColor = "rgba(240, 255, 240, 0.11)";
                }
                document.getElementById("player-inventory-stuff1").style.backgroundColor = "rgba(240, 255, 240, 0.11)";
                document.getElementById("player-inventory-stuff2").style.backgroundColor = "rgba(240, 255, 240, 0.11)";
                document.getElementById("player-inventory-stuff3").style.backgroundColor = "rgba(240, 255, 240, 0.11)";
                document.getElementById("player-inventory-stuff4").style.backgroundColor = "rgba(240, 255, 240, 0.11)";
            }

            this.onClickDropItem = this.onClickDropItem.bind(this)
            document.querySelector('#infos-drop').addEventListener('click', this.onClickDropItem)

            this.onClickUseItem = this.onClickUseItem.bind(this)
            document.querySelector('#infos-use').addEventListener('click', this.onClickUseItem)

            this.onClickOptionItem = this.onClickOptionItem.bind(this)
            document.querySelector('#ItemOption_Button').addEventListener('click', this.onClickOptionItem)

            this.onClickOptionMin = this.onClickOptionMin.bind(this)
            document.querySelector('#ItemOption_Min').addEventListener('click', this.onClickOptionMin)

            this.onClickOptionMiddle = this.onClickOptionMiddle.bind(this)
            document.querySelector('#ItemOption_Middle').addEventListener('click', this.onClickOptionMiddle)

            this.onClickOptionMax = this.onClickOptionMax.bind(this)
            document.querySelector('#ItemOption_Max').addEventListener('click', this.onClickOptionMax)

            this.onClickOptionInput = this.onClickOptionInput.bind(this)
            document.querySelector('#ItemOption_input').addEventListener('input', this.onClickOptionInput)

            document.addEventListener('mousemove', this.moveHandler);
            document.addEventListener('mousedown', this.mouseDownHandler);
            document.addEventListener('mouseup', this.mouseUpHandler);
        }

        disableContextMenu() {
            document.oncontextmenu = function() {
                return false;
            }
        }

        enableContextMenu() {
            document.oncontextmenu = null;
        }

        onClickDropItem(evt) {
            if (this.currentIdShow !== null) {
                CloseInfoBox();
                document.getElementById("ItemOption").style.visibility = "visible"
                document.getElementById("ItemOption_nom").innerHTML = document.getElementById("infos-title").innerHTML
                document.getElementById("ItemOption_Button").innerHTML = "Jeter"
                document.getElementById("ItemOption_input").setAttribute("item-using", false)
                document.getElementById("ItemOption_input").setAttribute("item-drop", true)
                document.getElementById("ItemOption_input").setAttribute("item-id", this.currentIdShow)
                document.getElementById("ItemOption_input").setAttribute("item-Count", this.currentCountShow)
                this.currentIdShow = null
            }
        }

        onClickUseItem(evt) {
            if (this.currentIdShow !== null) {
                CloseInfoBox();
                document.getElementById("ItemOption").style.visibility = "visible"
                document.getElementById("ItemOption_nom").innerHTML = document.getElementById("infos-title").innerHTML
                document.getElementById("ItemOption_Button").innerHTML = "Utiliser"
                document.getElementById("ItemOption_input").setAttribute("item-using", true)
                document.getElementById("ItemOption_input").setAttribute("item-drop", false)
                document.getElementById("ItemOption_input").setAttribute("item-id", this.currentIdShow)
                document.getElementById("ItemOption_input").setAttribute("item-Count", this.currentCountShow)
                this.currentIdShow = null
            }
        }

        onClickOptionInput(evt){
            document.getElementById("ItemOption_input").value = parseInt(document.getElementById("ItemOption_input").value)
        }

        onClickOptionMin(evt){
            document.getElementById("ItemOption_input").value = 1
        }

        onClickOptionMiddle(evt){
            alert(Math.ceil(document.getElementById("ItemOption_input").getAttribute("item-Count") / 2))
            document.getElementById("ItemOption_input").value = Math.ceil(document.getElementById("ItemOption_input").getAttribute("item-Count") / 2)
        }

        onClickOptionMax(evt){
            alert(document.getElementById("ItemOption_input").getAttribute("item-Count"))
            document.getElementById("ItemOption_input").value = document.getElementById("ItemOption_input").getAttribute("item-Count")
        }

        onClickOptionItem(evt) {
            CloseInfoBox()
            if(document.getElementById("ItemOption_input").value > 0){
                inventory.removeItem(document.getElementById("ItemOption_input").getAttribute("item-id"), document.getElementById("ItemOption_input").getAttribute("item-using"), document.getElementById("ItemOption_input").getAttribute("item-drop"), parseInt(document.getElementById("ItemOption_input").value))
            }
        }

        destroy() {
            document.removeEventListener('mousemove', this.moveHandler);
            document.removeEventListener('mousedown', this.mouseDownHandler);
            document.removeEventListener('mouseup', this.mouseUpHandler);
        }
    }

    function CloseInfoBox(){
        document.getElementById("item-info").style.visibility = "hidden";
        document.getElementById("infos-use").style.visibility = "hidden";
        document.getElementById("ItemOption").style.visibility = "hidden";
    }


    /* EXEMPLE */
    var mouse = new MouseTracker();

    mouse.disableContextMenu()

    //Instancie un nouvel inventaire
    var inventory = new Inventory('player-inventory')
</script>