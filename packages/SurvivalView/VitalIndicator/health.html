<html>

<head>
    <link rel="stylesheet" type="text/css" href="health.css" />
</head>

<body>
    <div>
        <ul class="list-notifications" id="list-notifications"></ul>
        <canvas id="c" width="150" height="40"></canvas>
        <div class="progress">
            <img src="burger.png" class="image">
            <div class="container1">
                <div class="progress1 progress-striped1">
                    <div class="progress-bar1" id="faim">
                    </div>
                </div>
            </div>
            <img src="water.png" class="image2">
            <div class="container2">
                <div class="progress2 progress-striped2">
                    <div class="progress-bar2" id="soif">
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script src="../Ressources/Js/config.js"></script>
    <script>
        var life = 100;

        function drawLine(ctx, y, h) {
            ctx.globalCompositeOperation = 'source-over';
            ctx.fillRect(0, y, ctx.canvas.width, h);
            ctx.globalCompositeOperation = 'destination-out';

            ctx.beginPath();
            ctx.moveTo(0, 20);
            ctx.lineTo(5, 20);
            ctx.lineTo(7, 20 - (1 / 100) * life);
            ctx.lineTo(10, 20 + (2 / 100) * life);
            ctx.lineTo(17, 20 - (2 / 100) * life);
            ctx.lineTo(23, 20 + (14 / 100) * life);
            ctx.lineTo(29, 20 - (14 / 100) * life);
            ctx.lineTo(34, 20 + (2 / 100) * life);
            ctx.lineTo(40, 20 - (2 / 100) * life);
            ctx.lineTo(47, 20);

            ctx.lineTo(50, 20);
            ctx.lineTo(52, 20 - (1 / 100) * life);
            ctx.lineTo(55, 20 + (2 / 100) * life);
            ctx.lineTo(62, 20 - (2 / 100) * life);
            ctx.lineTo(68, 20 + (14 / 100) * life);
            ctx.lineTo(74, 20 - (14 / 100) * life);
            ctx.lineTo(79, 20 + (2 / 100) * life);
            ctx.lineTo(85, 20 - (2 / 100) * life);
            ctx.lineTo(92, 20);

            ctx.lineTo(96, 20);
            ctx.lineTo(98, 20 - (1 / 100) * life);
            ctx.lineTo(101, 20 + (2 / 100) * life);
            ctx.lineTo(108, 20 - (2 / 100) * life);
            ctx.lineTo(114, 20 + (14 / 100) * life);
            ctx.lineTo(120, 20 - (14 / 100) * life);
            ctx.lineTo(125, 20 + (2 / 100) * life);
            ctx.lineTo(131, 20 - (2 / 100) * life);
            ctx.lineTo(138, 20);
            ctx.lineTo(200, 20);
            ctx.stroke();
        }

        var canvas = document.getElementById('c');
        var ctx = canvas.getContext('2d');

        var lines = 1;

        for (var i = 0; i < lines; i++) {
            drawLine(ctx, i * (canvas.height / lines), canvas.height / lines);
        }

        function UpdateVie(_life) {
            if (_life > 74 && _life < 101) {
                document.getElementById("c").style.background = "-webkit-linear-gradient(left, black 0%, green 100%)";
            }
            if (_life > 49 && _life < 75) {
                document.getElementById("c").style.background = "-webkit-linear-gradient(left, black 0%, yellow 100%)";
            }
            if (_life > 24 && _life < 50) {
                document.getElementById("c").style.background = "-webkit-linear-gradient(left, black 0%, orange 100%)";
            }
            if (_life >= 0 && _life < 25) {
                document.getElementById("c").style.background = "-webkit-linear-gradient(left, black 0%, red 100%)";
            }
            ctx.clearRect(0, 0, 150, 40);
            life = _life;
            var lines = 1;
            for (var i = 0; i < lines; i++) {
                drawLine(ctx, i * (canvas.height / lines), canvas.height / lines);
            }
        }

        function UpdateVital(vie, faim, soif) {
            UpdateVie(vie);
            document.getElementById("faim").style.width = faim + "%";
            document.getElementById("soif").style.width = soif + "%";
        }

        function newEl(tagType) {
            return document.createElement(tagType);
        }

        // Notification

        function AddNotification(id, msg, type="default", delay=20){
            let element = newEl('li');
            element.id = id.toString();
            element.classList.add(type.toString());
            element.innerHTML = msg.toString();

            let error = newEl('div');
            error.classList.add(type.toString());
            element.appendChild(error);

            document.getElementById("list-notifications").appendChild(element);

            setTimeout(function() {
                if(element !== "undefined"){
                    element.remove();
                }
            }, delay); 
            return element
        }

        function RemoveNotification(id){
            document.getElementById(id.toString()).remove()
        }

        function AddNotificationTimer(id, msg, delay){
            if(delay == null){
                return
            }
            
            alert(id+" "+msg+" "+MsToSeconds(delay))
            var thetime = MsToSeconds(delay);
            

            let element = newEl('li');
            element.id = id.toString();
            element.classList.add("default");
            element.innerHTML = msg.toString()+" "+thetime+"s";

            let error = newEl('div');
            error.classList.add("default");
            element.appendChild(error);

            document.getElementById("list-notifications").appendChild(element);

            var thetimer = setInterval(() => {
                thetime = thetime - 1
                element.innerHTML = msg.toString()+" "+thetime+"s";
            }, 1000);

            setTimeout(function() {
                if(element !== "undefined"){
                    element.remove();
                    clearInterval(thetimer);
                }
            }, delay); 
            return element
        }
    </script>
</body>

</html>
